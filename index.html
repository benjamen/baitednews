<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Baited News - Professional Post Generator</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      color: #333;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
      color: white;
    }

    .header h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 10px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .header p {
      font-size: 1.1rem;
      opacity: 0.9;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 450px 1fr;
      gap: 40px;
      align-items: start;
    }

    .controls {
      background: rgba(255, 255, 255, 0.98);
      padding: 35px;
      border-radius: 20px;
      backdrop-filter: blur(15px);
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.2);
      position: sticky;
      top: 20px;
    }

    .controls h2 {
      margin-top: 0;
      color: #2c3e50;
      font-size: 1.8rem;
      margin-bottom: 30px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section {
      margin-bottom: 25px;
      padding: 20px;
      background: rgba(248, 249, 250, 0.8);
      border-radius: 12px;
      border-left: 4px solid #3498db;
    }

    .section h3 {
      color: #2c3e50;
      font-size: 1.1rem;
      margin-bottom: 15px;
      font-weight: 600;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #34495e;
      font-size: 0.95rem;
    }

    input, textarea, select {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e1e8ed;
      border-radius: 10px;
      font-size: 15px;
      transition: all 0.3s ease;
      background: white;
      font-family: inherit;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
      transform: translateY(-1px);
    }

    textarea {
      resize: vertical;
      min-height: 120px;
      line-height: 1.5;
    }

    .toggle-group {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .toggle-btn {
      padding: 8px 16px;
      border: 2px solid #e1e8ed;
      border-radius: 8px;
      background: white;
      color: #666;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
      font-weight: 500;
    }

    .toggle-btn.active {
      background: #3498db;
      color: white;
      border-color: #3498db;
    }

    .slider-group {
      margin-top: 10px;
    }

    .slider {
      width: 100%;
      margin: 10px 0;
    }

    .slider-label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 5px;
    }

    .preview {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    .preview-container {
      position: relative;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
      background: white;
    }

    #svgPreview {
      max-width: 100%;
      height: auto;
      display: block;
    }

    .download-section {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .download-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 14px 28px;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .download-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }

    .download-btn:active {
      transform: translateY(0);
    }

    @media (max-width: 1024px) {
      .container {
        grid-template-columns: 1fr;
        gap: 30px;
      }
      
      .controls {
        position: static;
      }
    }

    @media (max-width: 768px) {
      .container {
        gap: 20px;
      }

      .controls {
        padding: 25px;
      }

      .header h1 {
        font-size: 2rem;
      }

      .download-section {
        flex-direction: column;
        align-items: center;
      }

      .download-btn {
        width: 100%;
        max-width: 300px;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>üé® Baited News Generator</h1>
    <p>Professional social media post creator with enhanced readability</p>
  </div>

  <div class="container">
    <div class="controls">
      <h2>‚öôÔ∏è Post Settings</h2>

      <div class="section">
        <h3>Content</h3>
        <div class="form-group">
          <label for="heading">Headline:</label>
          <textarea id="heading" placeholder="Enter your headline here...">$2.3M TOILETS FOR WELLINGTON WITH "DIVERSE LIGHTING"</textarea>
        </div>

        <div class="form-group">
          <label for="category">Category:</label>
          <select id="category">
            <option value="World" data-color="#4169e1">World</option>
            <option value="NZ" data-color="#ffeb3b">NZ</option>
            <option value="Business" data-color="#4b4b4b">Business</option>
            <option value="Politics" data-color="#007d21">Politics</option>
            <option value="Health" data-color="#00a3af">Health</option>
            <option value="Science & Tech" data-color="#8a2be2">Science & Tech</option>
            <option value="Climate" data-color="#228b22">Climate</option>
            <option value="Entertainment & Arts" data-color="#ff4500">Entertainment & Arts</option>
            <option value="Sport" data-color="#ffd700">Sport</option>
            <option value="Lifestyle" data-color="#b76e79">Lifestyle</option>
          </select>
        </div>

        <div class="form-group">
          <label for="author">Author:</label>
          <select id="author">
            <option value="michael ratcliffe">Michael Ratcliffe</option>
            <option value="chip windsor">Chip Windsor</option>
          </select>
        </div>
      </div>

      <div class="section">
        <h3>Visual Settings</h3>
        <div class="form-group">
          <label for="bgUpload">Background Image:</label>
          <input type="file" id="bgUpload" accept="image/*" />
        </div>

        <div class="form-group">
          <label>Text Enhancement:</label>
          <div class="toggle-group">
            <button type="button" class="toggle-btn active" data-enhancement="shadow">Text Shadow</button>
            <button type="button" class="toggle-btn" data-enhancement="outline">Text Outline</button>
            <button type="button" class="toggle-btn" data-enhancement="background">Text Background</button>
          </div>
        </div>

        <div class="form-group">
          <label for="fontColor">Headline Color:</label>
          <select id="fontColor">
            <option value="white" selected>White</option>
            <option value="black">Black</option>
            <option value="#ff4d6d">Pink</option>
            <option value="#3498db">Blue</option>
            <option value="#e74c3c">Red</option>
            <option value="#f39c12">Orange</option>
          </select>
        </div>

        <div class="slider-group">
          <div class="slider-label">
            <label>Background Opacity:</label>
            <span id="opacityValue">0.3</span>
          </div>
          <input type="range" id="bgOpacity" class="slider" min="0" max="1" step="0.1" value="0.3">
        </div>

        <div class="slider-group">
          <div class="slider-label">
            <label>Text Size:</label>
            <span id="textSizeValue">60</span>
          </div>
          <input type="range" id="textSize" class="slider" min="40" max="80" step="2" value="60">
        </div>
      </div>
    </div>

    <div class="preview">
      <div class="preview-container">
        <svg id="svgPreview" width="800" height="800" viewBox="0 0 800 800"></svg>
      </div>
      <div class="download-section">
        <button class="download-btn" onclick="downloadPNG()">
          üì• Download PNG
        </button>
        <button class="download-btn" onclick="downloadSVG()">
          üìä Download SVG
        </button>
      </div>
    </div>
  </div>

  <script>
    let logoDataUrl = '';
    let backgroundDataUrl = '';
    let currentEnhancement = 'shadow';
    
    // Try to load logo from GitHub
    fetch('logotrans.png')
      .then(res => res.blob())
      .then(blob => {
        const reader = new FileReader();
        reader.onload = () => { logoDataUrl = reader.result; generateSVG(); };
        reader.readAsDataURL(blob);
      })
      .catch(() => {
        console.log('Logo not found, using fallback');
        generateSVG();
      });

    // Background image upload
    document.getElementById('bgUpload').addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = () => { backgroundDataUrl = reader.result; generateSVG(); };
        reader.readAsDataURL(file);
      }
    });

    // Text enhancement toggles
    document.querySelectorAll('.toggle-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.toggle-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        currentEnhancement = this.dataset.enhancement;
        generateSVG();
      });
    });

    // Sliders
    document.getElementById('bgOpacity').addEventListener('input', function() {
      document.getElementById('opacityValue').textContent = this.value;
      generateSVG();
    });

    document.getElementById('textSize').addEventListener('input', function() {
      document.getElementById('textSizeValue').textContent = this.value;
      generateSVG();
    });

    function wrapText(text, maxCharsPerLine = 18) {
      const words = text.split(' ');
      const lines = [];
      let currentLine = '';
      
      words.forEach(word => {
        if (word.length > maxCharsPerLine) {
          if (currentLine) {
            lines.push(currentLine);
            currentLine = '';
          }
          for (let i = 0; i < word.length; i += maxCharsPerLine) {
            lines.push(word.slice(i, i + maxCharsPerLine));
          }
        } else {
          const testLine = currentLine + (currentLine ? ' ' : '') + word;
          if (testLine.length <= maxCharsPerLine) {
            currentLine = testLine;
          } else {
            if (currentLine) {
              lines.push(currentLine);
              currentLine = word;
            } else {
              lines.push(word);
              currentLine = '';
            }
          }
        }
      });
      
      if (currentLine) lines.push(currentLine);
      return lines;
    }

    function getContrastColor(hex) {
      hex = hex.replace('#', '');
      const r = parseInt(hex.substr(0, 2), 16);
      const g = parseInt(hex.substr(2, 2), 16);
      const b = parseInt(hex.substr(4, 2), 16);
      const brightness = (r * 299 + g * 587 + b * 114) / 1000;
      return brightness > 128 ? 'black' : 'white';
    }

    function generateTextStyle(color, enhancement) {
      let style = `fill="${color}" font-weight="bold"`;
      
      switch(enhancement) {
        case 'shadow':
          style += ` stroke="rgba(0,0,0,0.8)" stroke-width="2" filter="drop-shadow(3px 3px 6px rgba(0,0,0,0.7))"`;
          break;
        case 'outline':
          style += ` stroke="rgba(0,0,0,0.9)" stroke-width="3"`;
          break;
        case 'background':
          // Background will be handled separately
          break;
      }
      
      return style;
    }

    function generateSVG() {
      const heading = document.getElementById('heading').value;
      const categorySelect = document.getElementById('category');
      const category = categorySelect.value;
      const selectedOption = categorySelect.options[categorySelect.selectedIndex];
      const categoryColor = selectedOption.getAttribute('data-color');
      const author = document.getElementById('author').value.toLowerCase();
      const fontColor = document.getElementById('fontColor').value;
      const bgOpacity = document.getElementById('bgOpacity').value;
      const textSize = parseInt(document.getElementById('textSize').value);
      
      const categoryTextColor = getContrastColor(categoryColor);
      const lines = wrapText(heading, 18);
      
      // Calculate text positioning
      const lineHeight = textSize + 10;
      const totalTextHeight = lines.length * lineHeight;
      const startY = (800 - totalTextHeight) / 2 + 100;
      
      // Generate headline text
      let headlineText = '';
      if (currentEnhancement === 'background') {
        // Add background rectangles for each line
        lines.forEach((line, index) => {
          const y = startY + (index * lineHeight);
          const textWidth = line.length * (textSize * 0.6);
          const rectWidth = textWidth + 40;
          const rectX = (800 - rectWidth) / 2;
          
          headlineText += `
            <rect x="${rectX}" y="${y - textSize + 10}" width="${rectWidth}" height="${textSize + 20}" 
                  rx="8" fill="rgba(0,0,0,0.7)" />
            <text x="400" y="${y}" font-size="${textSize}" font-family="Arial, sans-serif" 
                  fill="${fontColor}" font-weight="bold" text-anchor="middle">${line}</text>
          `;
        });
      } else {
        const textStyle = generateTextStyle(fontColor, currentEnhancement);
        headlineText = lines.map((line, index) => {
          const y = startY + (index * lineHeight);
          return `<text x="400" y="${y}" font-size="${textSize}" font-family="Arial, sans-serif" 
                        text-anchor="middle" ${textStyle}>${line}</text>`;
        }).join('');
      }

      const categoryWidth = category.length * 12 + 40;

      // Generate SVG
      let svg = `
        <svg xmlns="http://www.w3.org/2000/svg" width="800" height="800">
          <defs>
            <filter id="drop-shadow" x="-50%" y="-50%" width="200%" height="200%">
              <feDropShadow dx="3" dy="3" stdDeviation="6" flood-color="rgba(0,0,0,0.7)"/>
            </filter>
          </defs>
          
          ${backgroundDataUrl ? 
            `<image href="${backgroundDataUrl}" x="0" y="0" width="800" height="800" preserveAspectRatio="xMidYMid slice"/>
             <rect width="800" height="800" fill="rgba(0,0,0,${bgOpacity})"/>` : 
            `<rect width="800" height="800" fill="linear-gradient(135deg, #667eea 0%, #764ba2 100%)"/>`
          }
          
          <!-- Header -->
          <rect width="800" height="120" fill="rgba(255,255,255,0.95)" />
          <rect x="0" y="115" width="800" height="5" fill="linear-gradient(90deg, #667eea 0%, #764ba2 100%)" />
          
          <!-- Category Badge -->
          <rect x="${800 - categoryWidth - 40}" y="30" width="${categoryWidth}" height="60" rx="30" 
                fill="${categoryColor}" stroke="rgba(255,255,255,0.3)" stroke-width="2"/>
          <text x="${800 - categoryWidth / 2 - 40}" y="60" font-size="18" font-weight="bold" 
                font-family="Arial, sans-serif" text-anchor="middle" dominant-baseline="central" fill="${categoryTextColor}">${category}</text>
          
          <!-- Logo -->
          ${logoDataUrl ? 
            `<image href="${logoDataUrl}" x="40" y="22.5" width="75" height="75" preserveAspectRatio="xMidYMid meet"/>` : 
            `<circle cx="77.5" cy="60" r="35" fill="#667eea" stroke="white" stroke-width="3"/>
             <text x="77.5" y="70" font-size="24" font-weight="bold" fill="white" text-anchor="middle">BN</text>`
          }
          
          <!-- Headline -->
          ${headlineText}
          
          <!-- Footer -->
          <rect y="720" width="800" height="80" fill="rgba(0,0,0,0.9)"/>
          <rect y="720" width="800" height="3" fill="linear-gradient(90deg, #667eea 0%, #764ba2 100%)"/>
          <text x="400" y="770" font-size="20" font-family="Arial, sans-serif" fill="white" 
                font-weight="600" text-anchor="middle">
            ${author} <tspan fill="#ff4d6d">| @baitednews</tspan>
          </text>
        </svg>
      `;

      document.getElementById('svgPreview').innerHTML = svg;
    }

    function downloadPNG() {
      const svgElement = document.getElementById('svgPreview');
      const svgContent = svgElement.innerHTML;
      const fullSVG = `<svg xmlns='http://www.w3.org/2000/svg' width='800' height='800'>${svgContent}</svg>`;
      
      const canvas = document.createElement('canvas');
      canvas.width = 1600; // Higher resolution
      canvas.height = 1600;
      const ctx = canvas.getContext('2d');
      
      const img = new Image();
      img.onload = function() {
        ctx.drawImage(img, 0, 0, 1600, 1600);
        canvas.toBlob(function(blob) {
          const a = document.createElement('a');
          a.href = URL.createObjectURL(blob);
          a.download = 'baited-news-post.png';
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(a.href);
        }, 'image/png', 1.0);
      };
      
      const svgBlob = new Blob([fullSVG], { type: 'image/svg+xml;charset=utf-8' });
      img.src = URL.createObjectURL(svgBlob);
    }

    function downloadSVG() {
      const svgElement = document.getElementById('svgPreview');
      const svgContent = svgElement.innerHTML;
      const fullSVG = `<svg xmlns='http://www.w3.org/2000/svg' width='800' height='800'>${svgContent}</svg>`;
      
      const blob = new Blob([fullSVG], { type: 'image/svg+xml;charset=utf-8' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'baited-news-post.svg';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(a.href);
    }

    // Event listeners
    document.querySelectorAll('input, textarea, select').forEach(input => {
      input.addEventListener('input', generateSVG);
      input.addEventListener('change', generateSVG);
    });

    // Category color change
    document.getElementById('category').addEventListener('change', function () {
      const selectedOption = this.options[this.selectedIndex];
      const color = selectedOption.getAttribute('data-color');
      const contrast = getContrastColor(color);
      this.style.backgroundColor = color;
      this.style.color = contrast;
    });

    // Initialize
    window.addEventListener('DOMContentLoaded', () => {
      const category = document.getElementById('category');
      const selectedOption = category.options[category.selectedIndex];
      const color = selectedOption.getAttribute('data-color');
      const contrast = getContrastColor(color);
      category.style.backgroundColor = color;
      category.style.color = contrast;
      generateSVG();
    });
  </script>
</body>
</html>
